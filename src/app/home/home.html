<!-- Logo -->
<div class="position-absolute top-0 start-0 p-3">
    <a routerLink="/" class="d-inline-block">
        <img src="assets/images/FlightsightLogo.png" alt="Logo" class="img-fluid" style="max-width: 80px;">
    </a>
</div>

<div class="container text-center my-5">
    <h1 class="display-1 fw-bold">Flightsight</h1>

    @if (loading()) {
    <div class="d-flex justify-content-center my-5">
        <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Chargement...</span>
        </div>
    </div>
    }
    @else if (error()) {
    <div class="alert alert-danger">{{ error() }}</div>
    }
    @else {
    <div class="container mt-4">
        <div class="row justify-content-between align-items-center">
            <!-- Search -->
            <div class="col-md-8">
                <input type="text" class="form-control" placeholder="Rechercher un vol..." [(ngModel)]="searchQuery" />
            </div>

            <!-- Select search field -->
            <div class="col-md-2">
                <select class="form-select" [(ngModel)]="searchField">
                    <option value="flightNumber">Numéro de vol</option>
                    <option value="airline">Compagnie</option>
                    <option value="departureAirport">Aéroport de départ</option>
                    <option value="arrivalAirport">Aéroport d'arriver</option>
                </select>
            </div>
            <!-- Validate search -->
            <div class="col-md-2 col-12">
                <button type="button" class="btn btn-primary w-100" (click)="searchFlights()">
                    Rechercher
                </button>
            </div>
        </div>
    </div>

    <!-- Table for flights -->
    <div class="table-responsive mt-4">
        <table class="table table-striped table-hover text-start">
            <thead class="">
                <tr>
                    <th>Numéro de vol</th>
                    <th>Compagnie</th>
                    <th>Départ (Aéroport)</th>
                    <th>Arrivée (Aéroport)</th>
                    <th>Heure de départ</th>
                    <th>Heure d'arrivée</th>
                </tr>
            </thead>
            <tbody>
                @for (flight of flights(); track flight.flightId) {
                <tr (click)="goToFlightDetail(flight.flightId)" style="cursor: pointer;">
                    <td>{{ flight.flightNumber }}</td>
                    <td>{{ flight.airline }}</td>
                    <td>{{ flight.departureAirport }}</td>
                    <td>{{ flight.arrivalAirport }}</td>
                    <td>{{ flight.departureDatetime | date:'dd/MM/yyyy HH:mm':'UTC' }}</td>
                    <td>{{ flight.arrivalDatetime | date:'dd/MM/yyyy HH:mm':'UTC' }}</td>
                </tr>
                }
            </tbody>
        </table>
    </div>
    }
</div>